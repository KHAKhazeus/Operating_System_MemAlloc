(function(e){function t(t){for(var i,o,a=t[0],d=t[1],l=t[2],m=0,h=[];m<a.length;m++)o=a[m],r[o]&&h.push(r[o][0]),r[o]=0;for(i in d)Object.prototype.hasOwnProperty.call(d,i)&&(e[i]=d[i]);c&&c(t);while(h.length)h.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],i=!0,a=1;a<n.length;a++){var d=n[a];0!==r[d]&&(i=!1)}i&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},r={app:0},s=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/Operating_System_MemAlloc/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],d=a.push.bind(a);a.push=t,a=a.slice();for(var l=0;l<a.length;l++)t(a[l]);var c=d;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("96cf");var i=n("3b8d"),r=(n("55dd"),n("ac6a"),n("6b54"),n("cadf"),n("551c"),n("f751"),n("097d"),n("2b0e")),s=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("html",[n("head",[n("link",{attrs:{rel:"stylesheet",href:"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css",integrity:"sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T",crossorigin:"anonymous"}})]),n("body",[n("div",{staticClass:"btn-group btn-group-lg",staticStyle:{"margin-bottom":"10px"},attrs:{role:"group","aria-label":"..."}},[n("button",{staticClass:"btn btn-secondary",attrs:{type:"button",id:"allocate"}},[e._v("One Allocate")]),n("button",{staticClass:"btn btn-secondary",attrs:{type:"button",id:"merge"}},[e._v("One Merge Free")]),n("button",{staticClass:"btn btn-secondary",attrs:{type:"button",id:"consistent"}},[e._v("Consecutive")]),n("button",{staticClass:"btn btn-secondary",attrs:{type:"button",id:"back"}},[e._v("Back One")])]),n("div",{staticClass:"container-fluid",attrs:{id:"app"}},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-4",attrs:{id:"my-shuffle"}}),n("div",{staticClass:"col-md-1 my-sizer-element"}),n("div",{staticClass:"col-md-4",attrs:{id:"free-shuffle"}}),n("div",{staticClass:"col-md-2"},[n("div",{staticClass:"form-check"},[n("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"exampleRadios",id:"exampleRadios1",value:"Firstfit",checked:""}}),n("label",{staticClass:"form-check-label",attrs:{for:"exampleRadios1"}},[e._v("\n              First Fit\n            ")])]),n("div",{staticClass:"form-check"},[n("input",{staticClass:"form-check-input",attrs:{type:"radio",name:"exampleRadios",id:"exampleRadios2",value:"Bestfit"}}),n("label",{staticClass:"form-check-label",attrs:{for:"exampleRadios2"}},[e._v("\n              Best Fit\n            ")])])])])])])])}],a={name:"app",components:{}},d=a,l=n("2877"),c=Object(l["a"])(d,s,o,!1,null,null,null),m=c.exports,h=n("2f62");r["a"].use(h["a"]);var f=new h["a"].Store({state:{},mutations:{},actions:{}}),u=n("3a44"),p=n("d225"),y=n("b0b4"),w=640,g={ALLOCATED:!0,FREE:!1},b={FIRSTFIT:1,BESTFIT:2};function v(e,t){return e.start-t.start}function L(e,t){return e.start-t.start}function E(e,t){return e.length-t.length}var k=function(){function e(){Object(p["a"])(this,e),this.memoryList=[],this.allocateMethod=b.FIRSTFIT;var t=new I(w);t.start=1,t.end=640,this.freeList=[t]}return Object(y["a"])(e,[{key:"allocate",value:function(e){if(this.allocateMethod==b.FIRSTFIT){if(this.freeList=this.freeList.sort(L),this.freeList.length>0){for(var t in this.freeList){var n=this.freeList[t];if(n.length>=e.length){e.start=n.start,e.end=e.start+e.length-1,e.used=g.ALLOCATED,this.memoryList.push(e),this.memoryList=this.memoryList.sort(v),n.start=e.end+1,n.length=n.end-n.start+1,0==n.length&&this.freeList.splice(t,1),this.freeList=this.freeList.sort(L);break}}return e.used!=g.FREE}return!1}if(this.freeList.length>0){for(var t in this.freeList=this.freeList.sort(E),this.freeList){n=this.freeList[t];if(n.length>=e.length){e.start=n.start,e.end=e.start+e.length-1,e.used=g.ALLOCATED,this.memoryList.push(e),this.memoryList=this.memoryList.sort(v),n.start=e.end+1,n.length=n.end-n.start+1,0==n.length&&this.freeList.splice(t,1),this.freeList=this.freeList.sort(E);break}}return e.used!=g.FREE}return!1}},{key:"setMethod",value:function(e){"Firstfit"==e?this.allocateMethod=b.FIRSTFIT:"Bestfit"==e&&(this.allocateMethod=b.BESTFIT)}},{key:"retrieveFree",value:function(e){e.used=g.FREE,e.jobID=0,this.memoryList.splice(this.memoryList.indexOf(e),1),this.freeList.push(e),this.allocateMethod==b.FIRSTFIT?this.freeList=this.freeList.sort(L):this.freeList=this.freeList.sort(E)}},{key:"merge",value:function(){if(this.freeList=this.freeList.sort(v),this.freeList.length>0)for(var e=0;e<this.freeList.length;e++){if(console.log(e),e+1==this.freeList.length)break;var t=this.freeList[e],n=this.freeList[e+1];n.start-t.end==1&&(t.end=n.end,t.length=t.end-t.start+1,this.freeList.splice(e+1,1),console.log(e+1,"merged"))}this.allocateMethod==b.FIRSTFIT?this.freeList=this.freeList.sort(L):this.freeList=this.freeList.sort(E)}}]),e}(),I=function e(t){Object(p["a"])(this,e),this.length=t,this.start=-1,this.end=-1,this.used=g.FREE,this.jobID=0},B=n("1157"),M=n.n(B);r["a"].config.productionTip=!1;var x=[[1,130,"add"],[2,60,"add"],[3,100,"add"],[2,60,"free"],[4,200,"add"],[3,100,"free"],[1,130,"free"],[5,140,"add"],[6,60,"add"],[7,50,"add"],[6,60,"free"]],F=0,C=0;function T(e){return JSON.parse(JSON.stringify(e))}function O(e){var t=new k;return t.memoryList=T(e.memoryList),t.allocateMethod=e.allocateMethod,t.freeList=T(e.freeList),t}new r["a"]({store:f,render:function(e){return e(m)}}).$mount("#app");var A=function(e){this.element=e,this.initShuffle()};A.prototype.initShuffle=function(){this.shuffle=new u["a"](this.element,{itemSelector:".box",speed:250,easing:"ease",sizer:".my-sizer-element"})},A.prototype.getRandomColor=function(){return"#"+Math.random().toString(16).slice(2,8)};var S=[],R=[];function _(e){return new Promise(function(t){return setTimeout(t,e)})}x.forEach(function(e){var t=e[0];if(-1==R.indexOf(t)){var n=A.prototype.getRandomColor();R.push(t),S.push([t,n])}},R,S),A.prototype._generateBoxes=function(e){var t=[],n=0;for(n=0;n<e;n++){Math.random();var i=document.createElement("div");i.className="box col-md-12",i.style.backgroundColor=this.getRandomColor(),i.style.height="640px",t.push(i)}return t},A.prototype._getArrayOfElementsToAdd=function(){return this._generateBoxes(5)},A.prototype._getHtmlMarkupToAdd=function(){var e=document.createDocumentFragment();this._generateBoxes(5).forEach(function(t){e.appendChild(t)});var t=document.createElement("div");return t.className="row",t.appendChild(e),t.innerHTML},A.prototype.onAppendBoxes=function(){var e=this._getArrayOfElementsToAdd();e.forEach(function(e){this.shuffle.element.appendChild(e)},this),this.shuffle.add(e)},A.prototype.bindButton=function(){document.querySelector("#allocate").addEventListener("click",this.allocateNext.bind(this)),document.querySelector("#merge").addEventListener("click",this.mergeNext.bind(this)),document.querySelector("#back").addEventListener("click",this.backOnce.bind(this)),document.querySelector("#consistent").addEventListener("click",this.consistentNext.bind(this))},A.prototype.generateMemBlock=function(e){var t=document.createElement("div");if(t.className="box col-md-12 border border-dark rounded",e.used==g.FREE)t.style.backgroundColor="rgb(256,256,256)",t.innerHTML="<p>Free "+e.length+"K</p>";else{var n=e.jobID,i="rgb(256,256,256)";for(var r in S)if(S[r][0]==n){i=S[r][1],console.log(i);break}t.style.backgroundColor=i,t.innerHTML="<p>给作业"+e.jobID+"分配的"+e.length+"K</p>",t.style.color="white"}return t.style.height=e.length+"px",t.style.padding="1px",t.style.fontSize="small",t},A.prototype.refreshFree=function(){var e=this.mem.freeList,t=e;t=this.mem.allocateMethod==b.FIRSTFIT?t.sort(L):t.sort(E);var n=[];t.forEach(function(e){var t=A.prototype.generateMemBlock(e);this.shuffle.element.appendChild(t),n.push(t)},this),this.shuffle.add(n)},A.prototype.refreshMem=function(){var e=this.mem.memoryList,t=this.mem.freeList,n=[];n=n.concat(e,t),n=n.sort(v);var i=[];n.forEach(function(e){var t=A.prototype.generateMemBlock(e);this.shuffle.element.appendChild(t),i.push(t)},this),this.shuffle.add(i)},A.prototype.initMem=function(){this.mem=new k,this.refreshMem()},A.prototype.removeAll=function(){var e=this.shuffle.visibleItems;if(e){for(var t=[],n=0;n<e;n++)t.push(n);var i=t.map(function(e){return this.shuffle.items[e].element},this);this.shuffle.remove(i)}},A.prototype.allocateNext=function(){if(F>C){var e=window.cache[C+1][0];this.mem=e,window.freedynamic.mem=this.mem,this.removeAll(),this.refreshMem()}else{var t=x[C];if(console.log(t),"add"==t[2]){var n=new I(t[1]);n.jobID=t[0],this.mem.allocate(n),this.removeAll(),this.refreshMem()}else{var i=t[0],r=t[1];for(var s in this.mem.memoryList){var o=this.mem.memoryList[s];if(o.jobID==i&&o.length==r){this.mem.retrieveFree(o),this.removeAll(),this.refreshMem();break}}}}C>0&&(document.getElementById("back").disabled=!1),document.getElementById("allocate").disabled=!0,document.getElementById("merge").disabled=!1,document.getElementById("back").disabled=!0,window.freedynamic.removeAll(),window.freedynamic.refreshFree()},A.prototype.mergeNext=function(){if(C==x.length-1?(document.getElementById("allocate").disabled=!0,document.getElementById("consistent").disabled=!0):document.getElementById("allocate").disabled=!1,document.getElementById("merge").disabled=!0,document.getElementById("back").disabled=!1,F==C){var e=O(this.mem);this.mem.merge(),window.cache.push([e,O(this.mem)])}else{var t=window.cache[C+1][1];this.mem=t,window.freedynamic.mem=this.mem}F>C?C+=1:(C+=1,F+=1),this.removeAll(),this.refreshMem(),window.freedynamic.removeAll(),window.freedynamic.refreshFree()},A.prototype.backOnce=function(){if(C-1>=0){console.log("back"),C-=1,console.log(window.cache);var e=window.cache[C][0];this.mem=e,window.freedynamic.mem=this.mem,this.removeAll(),this.refreshMem()}0==C&&(document.getElementById("back").disabled=!0),document.getElementById("allocate").disabled=!1,document.getElementById("merge").disabled=!0,document.getElementById("consistent").disabled=!1,window.freedynamic.removeAll(),window.freedynamic.refreshFree()},A.prototype.consistentNext=Object(i["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<x.length)){e.next=19;break}return this.allocateNext(),document.getElementById("allocate").disabled=!0,document.getElementById("merge").disabled=!0,window.freedynamic.removeAll(),window.freedynamic.refreshFree(),e.next=9,_(1e3);case 9:return this.mergeNext(),document.getElementById("allocate").disabled=!0,document.getElementById("merge").disabled=!0,window.freedynamic.removeAll(),window.freedynamic.refreshFree(),e.next=16,_(1e3);case 16:t++,e.next=1;break;case 19:case"end":return e.stop()}},e,this)})),A.prototype.nextStep=function(){},document.addEventListener("DOMContentLoaded",function(){window.cache=[],window.dynamic=new A(document.getElementById("my-shuffle")),window.freedynamic=new A(document.getElementById("free-shuffle")),window.dynamic.initMem(),window.freedynamic.initMem(),window.freedynamic.mem=window.dynamic.mem,window.cache.push([O(window.dynamic.mem),O(window.dynamic.mem)]),window.dynamic.bindButton(),document.getElementById("back").disabled=!0,document.getElementById("allocate").disabled=!1,document.getElementById("merge").disabled=!0,M()(".form-check-input").on("click",function(){console.log(M()(this).val());var e=M()(this).val();"Bestfit"==e?(window.dynamic.removeAll(),window.freedynamic.removeAll(),window.cache=[],window.dynamic.initMem(),window.freedynamic.initMem(),window.freedynamic.mem=window.dynamic.mem,window.dynamic.mem.setMethod("Bestfit"),window.cache.push([O(window.dynamic.mem),O(window.dynamic.mem)]),F=0,C=0,document.getElementById("back").disabled=!0,document.getElementById("allocate").disabled=!1,document.getElementById("merge").disabled=!0):(window.dynamic.removeAll(),window.freedynamic.removeAll(),window.dynamic.initMem(),window.freedynamic.initMem(),window.freedynamic.mem=window.dynamic.mem,window.dynamic.mem.setMethod("Firstfit"),window.cache=[],window.cache.push([O(window.dynamic.mem),O(window.dynamic.mem)]),F=0,C=0,document.getElementById("back").disabled=!0,document.getElementById("allocate").disabled=!1,document.getElementById("merge").disabled=!0)})})}});
//# sourceMappingURL=app.11c26351.js.map